<!DOCTYPE html>
<html class="h-full">
  <head>
    <title><%= content_for(:title) || "McKrulvey Haus" %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a1a2e">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="h-full bg-slate-900 text-slate-100 antialiased" data-controller="navigation">
    <div class="flex flex-col h-full">
      <header class="bg-slate-800/80 backdrop-blur-sm border-b border-slate-700 safe-area-top">
        <div class="px-4 py-3 flex items-center justify-between">
          <%= link_to root_path, class: "flex items-center gap-2" do %>
            <span class="text-2xl">üè°</span>
            <span class="font-bold text-lg tracking-tight text-amber-400">McKrulvey Haus</span>
          <% end %>
          <div class="text-sm text-slate-400">
            <%= Time.current.strftime("%A, %b %d") %>
          </div>
        </div>
      </header>

      <% if notice.present? %>
        <div class="bg-emerald-900/50 border-b border-emerald-700 px-4 py-3 text-emerald-200" data-controller="flash" data-flash-target="message">
          <div class="flex items-center justify-between">
            <span><%= notice %></span>
            <button data-action="flash#dismiss" class="p-1 hover:bg-emerald-800 rounded">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
          </div>
        </div>
      <% end %>

      <% if alert.present? %>
        <div class="bg-red-900/50 border-b border-red-700 px-4 py-3 text-red-200" data-controller="flash" data-flash-target="message">
          <div class="flex items-center justify-between">
            <span><%= alert %></span>
            <button data-action="flash#dismiss" class="p-1 hover:bg-red-800 rounded">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
          </div>
        </div>
      <% end %>

      <main class="flex-1 overflow-y-auto pb-24">
        <%= yield %>
      </main>

      <nav class="fixed bottom-0 left-0 right-0 bg-slate-800/95 backdrop-blur-sm border-t border-slate-700 safe-area-bottom" data-navigation-target="nav">
        <div class="grid grid-cols-5 gap-1 px-2 py-2">
          <%= link_to root_path, class: "nav-item #{current_page?(root_path) ? 'nav-item-active' : ''}", data: { turbo_action: "replace" } do %>
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
            <span class="text-xs mt-1">Home</span>
          <% end %>

          <%= link_to pantry_path, class: "nav-item #{request.path.start_with?('/pantry') ? 'nav-item-active' : ''}", data: { turbo_action: "replace" } do %>
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path></svg>
            <span class="text-xs mt-1">Pantry</span>
          <% end %>

          <%= link_to animals_path, class: "nav-item #{request.path.start_with?('/animals') ? 'nav-item-active' : ''}", data: { turbo_action: "replace" } do %>
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
            <span class="text-xs mt-1">Animals</span>
          <% end %>

          <%= link_to rabbitry_path, class: "nav-item #{request.path.start_with?('/rabbitry') ? 'nav-item-active' : ''}", data: { turbo_action: "replace" } do %>
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
            <span class="text-xs mt-1">Rabbitry</span>
          <% end %>

          <%= link_to freezer_path, class: "nav-item #{request.path.start_with?('/freezer') ? 'nav-item-active' : ''}", data: { turbo_action: "replace" } do %>
            <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0v10l-8 4m8-14l-8 4m0 0L4 7m8 4v10M4 7v10l8 4"></path></svg>
            <span class="text-xs mt-1">Freezer</span>
          <% end %>
        </div>
      </nav>
    </div>
  </body>
</html>
